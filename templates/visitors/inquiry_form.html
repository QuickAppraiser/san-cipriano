{% extends "base.html" %}
{% load static i18n %}

{% block title %}{% trans "Planifica tu Visita" %}{% endblock %}

{% block content %}
<!-- Header -->
<section class="bg-gradient-to-br from-rio-600 to-selva-700 text-white py-16 px-4">
    <div class="max-w-4xl mx-auto text-center">
        <span class="inline-block text-6xl mb-4">üìã</span>
        <h1 class="font-display text-4xl md:text-5xl font-bold mb-4">
            {{ page_title }}
        </h1>
        <p class="text-rio-100 text-lg max-w-2xl mx-auto">
            {{ page_description }}
        </p>
    </div>
</section>

<!-- Info Banner -->
<section class="bg-amber-50 border-b border-amber-200 py-4 px-4">
    <div class="max-w-4xl mx-auto">
        <div class="flex items-center justify-center gap-3 text-amber-800">
            <svg class="w-5 h-5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            <p class="text-sm font-medium">
                {% trans "Los detalles y costos exactos se env√≠an de forma personalizada despu√©s del registro." %}
            </p>
        </div>
    </div>
</section>

<!-- Form Section -->
<section class="py-12 px-4">
    <div class="max-w-2xl mx-auto">

        {% if messages %}
        <div class="mb-8">
            {% for message in messages %}
            <div class="bg-green-50 border border-green-200 rounded-xl p-4 flex items-start gap-3">
                <svg class="w-6 h-6 text-green-500 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <p class="text-green-800">{{ message }}</p>
            </div>
            {% endfor %}
        </div>
        {% endif %}

        <form method="post" class="space-y-8">
            {% csrf_token %}

            <!-- Personal Information -->
            <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
                <div class="bg-selva-50 px-6 py-4 border-b border-selva-100">
                    <h2 class="font-semibold text-selva-900 flex items-center gap-2">
                        <span class="text-xl">üë§</span>
                        {% trans "Informaci√≥n Personal" %}
                    </h2>
                </div>
                <div class="p-6 space-y-4">
                    <!-- Full Name -->
                    <div>
                        <label for="id_full_name" class="block text-sm font-medium text-gray-700 mb-1">
                            {% trans "Nombre completo" %} <span class="text-red-500">*</span>
                        </label>
                        <input type="text" name="full_name" id="id_full_name" required
                               class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-selva-500 focus:border-selva-500 transition-colors"
                               placeholder="{% trans 'Tu nombre completo' %}">
                        {% if form.full_name.errors %}
                        <p class="mt-1 text-sm text-red-600">{{ form.full_name.errors.0 }}</p>
                        {% endif %}
                    </div>

                    <!-- Phone -->
                    <div>
                        <label for="id_phone" class="block text-sm font-medium text-gray-700 mb-1">
                            {% trans "Tel√©fono / WhatsApp" %} <span class="text-red-500">*</span>
                        </label>
                        <input type="tel" name="phone" id="id_phone" required
                               class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-selva-500 focus:border-selva-500 transition-colors"
                               placeholder="+57 300 123 4567">
                        {% if form.phone.errors %}
                        <p class="mt-1 text-sm text-red-600">{{ form.phone.errors.0 }}</p>
                        {% endif %}
                    </div>

                    <!-- Email -->
                    <div>
                        <label for="id_email" class="block text-sm font-medium text-gray-700 mb-1">
                            {% trans "Correo electr√≥nico" %} <span class="text-red-500">*</span>
                        </label>
                        <input type="email" name="email" id="id_email" required
                               class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-selva-500 focus:border-selva-500 transition-colors"
                               placeholder="{% trans 'tu@correo.com' %}">
                        {% if form.email.errors %}
                        <p class="mt-1 text-sm text-red-600">{{ form.email.errors.0 }}</p>
                        {% endif %}
                    </div>

                    <!-- City & Country -->
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <div>
                            <label for="id_city" class="block text-sm font-medium text-gray-700 mb-1">
                                {% trans "Ciudad" %} <span class="text-red-500">*</span>
                            </label>
                            <input type="text" name="city" id="id_city" required
                                   class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-selva-500 focus:border-selva-500 transition-colors"
                                   placeholder="{% trans 'Bogot√°, Cali...' %}">
                        </div>
                        <div>
                            <label for="id_country" class="block text-sm font-medium text-gray-700 mb-1">
                                {% trans "Pa√≠s" %} <span class="text-red-500">*</span>
                            </label>
                            <input type="text" name="country" id="id_country" value="Colombia" required
                                   class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-selva-500 focus:border-selva-500 transition-colors"
                                   placeholder="Colombia">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Visit Details -->
            <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
                <div class="bg-rio-50 px-6 py-4 border-b border-rio-100">
                    <h2 class="font-semibold text-rio-900 flex items-center gap-2">
                        <span class="text-xl">üìÖ</span>
                        {% trans "Detalles de la Visita" %}
                    </h2>
                </div>
                <div class="p-6 space-y-4">
                    <!-- Dates -->
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <div>
                            <label for="id_estimated_arrival" class="block text-sm font-medium text-gray-700 mb-1">
                                {% trans "Fecha estimada de llegada" %}
                            </label>
                            <input type="date" name="estimated_arrival" id="id_estimated_arrival"
                                   class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-rio-500 focus:border-rio-500 transition-colors">
                        </div>
                        <div>
                            <label for="id_estimated_departure" class="block text-sm font-medium text-gray-700 mb-1">
                                {% trans "Fecha estimada de salida" %}
                            </label>
                            <input type="date" name="estimated_departure" id="id_estimated_departure"
                                   class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-rio-500 focus:border-rio-500 transition-colors">
                        </div>
                    </div>

                    <!-- People Count -->
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <div>
                            <label for="id_number_of_people" class="block text-sm font-medium text-gray-700 mb-1">
                                {% trans "N√∫mero de personas" %} <span class="text-red-500">*</span>
                            </label>
                            <input type="number" name="number_of_people" id="id_number_of_people"
                                   min="1" max="50" value="1" required
                                   class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-rio-500 focus:border-rio-500 transition-colors">
                        </div>
                        <div>
                            <label for="id_number_of_children" class="block text-sm font-medium text-gray-700 mb-1">
                                {% trans "Menores de 18 a√±os" %}
                            </label>
                            <input type="number" name="number_of_children" id="id_number_of_children"
                                   min="0" max="20" value="0"
                                   class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-rio-500 focus:border-rio-500 transition-colors">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Services -->
            <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
                <div class="bg-tierra-50 px-6 py-4 border-b border-tierra-100">
                    <h2 class="font-semibold text-tierra-900 flex items-center gap-2">
                        <span class="text-xl">üéØ</span>
                        {% trans "Servicios de Inter√©s" %}
                    </h2>
                    <p class="text-sm text-tierra-600 mt-1">
                        {% trans "Selecciona los servicios que te interesan" %} <span class="text-red-500">*</span>
                    </p>
                </div>
                <div class="p-6">
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                        <label class="flex items-center gap-3 p-3 border border-gray-200 rounded-xl hover:bg-gray-50 cursor-pointer transition-colors">
                            <input type="checkbox" name="services" value="alimentacion"
                                   class="w-5 h-5 text-selva-600 border-gray-300 rounded focus:ring-selva-500">
                            <span class="text-2xl">üçΩÔ∏è</span>
                            <span class="font-medium text-gray-700">{% trans "Alimentaci√≥n" %}</span>
                        </label>

                        <label class="flex items-center gap-3 p-3 border border-gray-200 rounded-xl hover:bg-gray-50 cursor-pointer transition-colors">
                            <input type="checkbox" name="services" value="transporte"
                                   class="w-5 h-5 text-selva-600 border-gray-300 rounded focus:ring-selva-500">
                            <span class="text-2xl">üöÉ</span>
                            <span class="font-medium text-gray-700">{% trans "Transporte (Brujitas)" %}</span>
                        </label>

                        <label class="flex items-center gap-3 p-3 border border-gray-200 rounded-xl hover:bg-gray-50 cursor-pointer transition-colors">
                            <input type="checkbox" name="services" value="alimentacion_transporte"
                                   class="w-5 h-5 text-selva-600 border-gray-300 rounded focus:ring-selva-500">
                            <span class="text-2xl">üì¶</span>
                            <span class="font-medium text-gray-700">{% trans "Alimentaci√≥n + Transporte" %}</span>
                        </label>

                        <label class="flex items-center gap-3 p-3 border border-gray-200 rounded-xl hover:bg-gray-50 cursor-pointer transition-colors">
                            <input type="checkbox" name="services" value="hospedaje"
                                   class="w-5 h-5 text-selva-600 border-gray-300 rounded focus:ring-selva-500">
                            <span class="text-2xl">üè†</span>
                            <span class="font-medium text-gray-700">{% trans "Hospedaje" %}</span>
                        </label>

                        <label class="flex items-center gap-3 p-3 border border-gray-200 rounded-xl hover:bg-gray-50 cursor-pointer transition-colors">
                            <input type="checkbox" name="services" value="guia"
                                   class="w-5 h-5 text-selva-600 border-gray-300 rounded focus:ring-selva-500">
                            <span class="text-2xl">üß≠</span>
                            <span class="font-medium text-gray-700">{% trans "Gu√≠a tur√≠stico" %}</span>
                        </label>

                        <label class="flex items-center gap-3 p-3 border border-gray-200 rounded-xl hover:bg-gray-50 cursor-pointer transition-colors">
                            <input type="checkbox" name="services" value="parqueadero"
                                   class="w-5 h-5 text-selva-600 border-gray-300 rounded focus:ring-selva-500">
                            <span class="text-2xl">üÖøÔ∏è</span>
                            <span class="font-medium text-gray-700">{% trans "Parqueadero" %}</span>
                        </label>

                        <label class="flex items-center gap-3 p-3 border border-gray-200 rounded-xl hover:bg-gray-50 cursor-pointer transition-colors">
                            <input type="checkbox" name="services" value="entrada"
                                   class="w-5 h-5 text-selva-600 border-gray-300 rounded focus:ring-selva-500">
                            <span class="text-2xl">üé´</span>
                            <span class="font-medium text-gray-700">{% trans "Entrada a la reserva" %}</span>
                        </label>

                        <label class="flex items-center gap-3 p-3 border border-gray-200 rounded-xl hover:bg-gray-50 cursor-pointer transition-colors">
                            <input type="checkbox" name="services" value="tours"
                                   class="w-5 h-5 text-selva-600 border-gray-300 rounded focus:ring-selva-500">
                            <span class="text-2xl">ü•æ</span>
                            <span class="font-medium text-gray-700">{% trans "Tours guiados" %}</span>
                        </label>

                        <label class="flex items-center gap-3 p-3 border border-gray-200 rounded-xl hover:bg-gray-50 cursor-pointer transition-colors">
                            <input type="checkbox" name="services" value="experiencias"
                                   class="w-5 h-5 text-selva-600 border-gray-300 rounded focus:ring-selva-500">
                            <span class="text-2xl">üåø</span>
                            <span class="font-medium text-gray-700">{% trans "Experiencias naturales" %}</span>
                        </label>

                        <label class="flex items-center gap-3 p-3 border border-gray-200 rounded-xl hover:bg-gray-50 cursor-pointer transition-colors">
                            <input type="checkbox" name="services" value="otro"
                                   class="w-5 h-5 text-selva-600 border-gray-300 rounded focus:ring-selva-500">
                            <span class="text-2xl">‚ùì</span>
                            <span class="font-medium text-gray-700">{% trans "Otros" %}</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Special Requests -->
            <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
                <div class="bg-gray-50 px-6 py-4 border-b border-gray-100">
                    <h2 class="font-semibold text-gray-900 flex items-center gap-2">
                        <span class="text-xl">üí¨</span>
                        {% trans "Solicitudes Especiales" %}
                    </h2>
                </div>
                <div class="p-6">
                    <textarea name="special_requests" id="id_special_requests" rows="3"
                              class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-selva-500 focus:border-selva-500 transition-colors"
                              placeholder="{% trans '¬øTienes alguna pregunta, alergia o necesidad especial?' %}"></textarea>
                </div>
            </div>

            <!-- Privacy Consent -->
            <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6">
                <label class="flex items-start gap-3 cursor-pointer">
                    <input type="checkbox" name="privacy_consent" required
                           class="w-5 h-5 mt-0.5 text-selva-600 border-gray-300 rounded focus:ring-selva-500">
                    <span class="text-gray-700">
                        {% trans "Acepto que mis datos sean utilizados para contactarme y recibir informaci√≥n sobre mi visita a San Cipriano." %}
                        <span class="text-red-500">*</span>
                    </span>
                </label>
            </div>

            <!-- Submit Button -->
            <div class="text-center">
                <button type="submit"
                        class="inline-flex items-center gap-2 px-10 py-4 bg-selva-600 hover:bg-selva-700 text-white text-lg font-semibold rounded-xl shadow-lg transition-all hover:scale-105">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                    </svg>
                    {% trans "Enviar Solicitud" %}
                </button>
                <p class="mt-4 text-gray-500 text-sm">
                    {% trans "Una vez recibamos tus datos, la comunidad te enviar√° la informaci√≥n completa y personalizada." %}
                </p>
            </div>

        </form>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
    // Set minimum date to today
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('id_estimated_arrival').setAttribute('min', today);
    document.getElementById('id_estimated_departure').setAttribute('min', today);

    // Update departure min date when arrival changes
    document.getElementById('id_estimated_arrival').addEventListener('change', function() {
        document.getElementById('id_estimated_departure').setAttribute('min', this.value);
    });

    // Form validation feedback
    document.querySelector('form').addEventListener('submit', function(e) {
        const services = document.querySelectorAll('input[name="services"]:checked');
        if (services.length === 0) {
            e.preventDefault();
            alert("{% trans 'Por favor selecciona al menos un servicio de inter√©s.' %}");
        }
    });
</script>
{% endblock %}
